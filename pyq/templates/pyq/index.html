<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ user_login.username }}</title>

    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'pyq/index.css' %}" />

</head>

<body class="index">

<h1>{{ user_login.username }}</h1>
<form action="{% url 'account:logout' %}" method="post">
    {% csrf_token %}
    <input type="submit" value="Log Out" />
</form>
<br>

<form action="{% url 'pyq:post_action' user_login.sid pages user_login.id %}" method='post' enctype="multipart/form-data">
    {% csrf_token %}
    <div>
        <textarea style="" name="context" placeholder="What do you want to post?" rows="3" cols='120'></textarea>
        <input type="hidden" name="type_change" value="add"/>
    </div>
    <div>
        <input type="submit" value="submit" style="float: right"/><br>
    </div>
</form>


<hr>

<script>
    function editFunc()
    {
        window.open("edit.html");
    }
</script>


<div>
    <div id="post_list_item">
        {% for post in posts %}
                <div class="fieldset">
                {% if post.user_now == user_login %}
                    <div class="self_post">
                    <h1><span>{{ post.user_now }}</span></h1>
                    <p><content>{{ post.context }}&nbsp &nbsp &nbsp</content><br>
                        created: {{ post.created_time }}&nbsp &nbsp &nbsp
                        {% if post.edit_time != post.created_time %}
                            edited
                        {% endif %}
                    </p>
                    </div>
                {% else %}
                    <div class="not_self_post">
                    <h1><span>{{ post.user_now }}</span></h1>
                    <p><content>&nbsp &nbsp &nbsp{{ post.context }}</content><br>
                        created: {{ post.created_time }}&nbsp &nbsp &nbsp
                        {% if post.edit_time != post.created_time %}
                            edited
                        {% endif %}
                    </p>
                    </div>
                {% endif %}
                    <table align="center">
                    <tr>
                    <td>
                    {% if post.user_now == user_login %}
                        <!--
                        <button onclick="editFunc()">edit</button>
                        -->

                        <form action="{% url 'pyq:post_action' user_login.sid pages post.pid %}" method="post">
                            {% csrf_token %}

                            <input type="submit" value="edit"/>

                            <input type="hidden" name="type_change" value="edit"/>

                        </form>
                    {% endif %}
                    </td>
                    <td>
                    {% if post.user_now == user_login or user_login.permission %}
                        <form action="{% url 'pyq:post_action' user_login.sid pages post.pid %}" method="post">
                            {% csrf_token %}
                            <button onclick="return DeleteConfirmFunc()">Delete</button>
                            <script>
                                function DeleteConfirmFunc()
                                {
                                    return confirm("Are u sure to DELETE?");
                                }
                            </script>
                            <input type="hidden" name="type_change" value="delete"/>
                        </form>
                    {% endif %}
                    </td>
                    </tr>
                    </table>
                </div>

        {% endfor %}
    </div>
</div>
<div>
    {% if more_pages %}
        <form action="{% url 'pyq:post_action' user_login.sid pages user_login.id %}" method="post">
            {% csrf_token %}
            <input type="submit" value="load more">
            <!--<input type="hidden" name="pages" value="<%=pages%>">-->
            <input type="hidden" name="type_change" value="load_more">
        </form>
    {% else %}
        <p>Already the last post</p>
    {% endif %}
</div>

</body>
</html>